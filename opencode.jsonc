{
  "$schema": "https://opencode.ai/config.json",
  
  // === Plugins ===
  "plugin": [
    "oh-my-opencode",
    "opencode-openai-codex-auth"
  ],
  
  // === Models ===
  "model": "anthropic/claude-opus-4-5",
  "small_model": "anthropic/claude-haiku-4-5",  // title gen, lightweight tasks
  "autoupdate": true,
  
  // === TUI ===
  "tui": {
    "scroll_acceleration": {
      "enabled": true  // macOS-style momentum scrolling
    }
  },
  
  // === Formatters ===
  // Swift formatting handled by Xcode / swift-format in project configs
  
  // === Instructions ===
  // AGENTS.md auto-loaded from ~/.config/opencode/ and repo root
  // Knowledge files (knowledge/*.md) are loaded on-demand via @path references
  
  // === Permissions ===
  "permission": {
    // Doom loop protection - ask if same tool+args called 3x
    "doom_loop": "ask",
    
    // .env reads without prompts
    "read": {
      ".env": "allow",
      ".env.*": "allow",
      ".env-*": "allow"
    },
    "external_directory": "allow",
    // Only deny the truly catastrophic - everything else just runs
    "bash": {
      "sudo *": "deny",
      "rm -rf /": "deny",
      "rm -rf /*": "deny",
      "rm -rf ~": "deny",
      "rm -rf ~/*": "deny",
      ":(){:|:&};:": "deny"  // fork bomb, just in case
    }
  },

  // === MCP Servers ===
  // MCPs removed - swarm plugin provides agentmail_* wrappers via direct HTTP
  // This avoids duplicate tools (was causing 201+ tools, breaking grok-code's 200 limit)
  
  // === OpenAI Codex Provider (ChatGPT Pro subscription) ===
  "provider": {
    "openai": {
      "options": {
        "reasoningEffort": "medium",
        "reasoningSummary": "auto",
        "textVerbosity": "medium",
        "include": ["reasoning.encrypted_content"],
        "store": false
      },
      "models": {
        "gpt-5.2-medium": {
          "name": "GPT 5.2 Medium (OAuth)",
          "limit": { "context": 272000, "output": 128000 },
          "modalities": { "input": ["text", "image"], "output": ["text"] },
          "options": {
            "reasoningEffort": "medium",
            "reasoningSummary": "auto",
            "textVerbosity": "medium",
            "include": ["reasoning.encrypted_content"],
            "store": false
          }
        },
        "gpt-5.2-high": {
          "name": "GPT 5.2 High (OAuth)",
          "limit": { "context": 272000, "output": 128000 },
          "modalities": { "input": ["text", "image"], "output": ["text"] },
          "options": {
            "reasoningEffort": "high",
            "reasoningSummary": "detailed",
            "textVerbosity": "medium",
            "include": ["reasoning.encrypted_content"],
            "store": false
          }
        },
        "gpt-5.1-codex-medium": {
          "name": "GPT 5.1 Codex Medium (OAuth)",
          "limit": { "context": 272000, "output": 128000 },
          "modalities": { "input": ["text", "image"], "output": ["text"] },
          "options": {
            "reasoningEffort": "medium",
            "reasoningSummary": "auto",
            "textVerbosity": "medium",
            "include": ["reasoning.encrypted_content"],
            "store": false
          }
        }
      }
    }
  },

  // === Agent Overrides ===
  "agent": {
    // Build agent - full capability with slight creativity
    "build": {
      "temperature": 0.3
    },
    // Plan agent - read-only analysis, no file writes
    "plan": {
      "model": "anthropic/claude-opus-4-5",  // Opus for planning
      "temperature": 0.1,
      "tools": {
        "write": false,
        "edit": false,
        "patch": false
      },
      "permission": {
        "bash": {
          "git status": "allow",
          "git diff*": "allow",
          "git log*": "allow",
          "git show*": "allow",
          "bd *": "allow",
          "rg *": "allow",
          "tree *": "allow",
          "wc *": "allow",
          "head *": "allow",
          "tail *": "allow",
          "swift build*": "allow",
          "swift test*": "allow",
          "xcodebuild *": "allow",
          "xcrun *": "allow",
          // xcode-cli-tools wrapper scripts
          "\"/Users/dalecarman/Groove Jones Dropbox/Dale Carman/Projects/dev/xcode-cli-tools/.claude/scripts/\"*": "allow",
          "*": "deny"
        }
      }
    },
    // Docs agent - documentation writer (cheaper model)
    "docs": {
      "model": "anthropic/claude-haiku-4-5",  // Haiku for cost-effective docs
      "temperature": 0.3,  // More creativity for readable documentation
      "permission": {
        "write": {
          "**/*.md": "allow",
          "**/*.mdx": "allow",
          "*": "deny"
        }
      },
      "description": "Documentation writer - generates and updates markdown docs, READMEs, and guides. Can only write to .md/.mdx files."
    }
  }
}
